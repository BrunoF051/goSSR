<div
    class="container"
    style="
        display: flex;
        flex-direction: column;
        gap: 1rem;
        align-items: center;
        justify-content: center;
        margin: 2rem;
    "
    x-data="{
                    resetForm: {{.ResetForm}},
                    fileError: '',
                    validateFile(event) {
                        const file = event.target.files[0];
                        if (file && file.size > 5 * 1024 * 1024) {
                            this.fileError = 'File size exceeds 5MB limit';
                        } else {
                            this.fileError = '';
                        }
                    }
                }"
    x-init="$watch('resetForm', function(newValue) {
                    if (newValue) {
                        $refs.uploadForm.reset();
                        resetForm = false;
                    }
                })"
>
    <h1>{{.Title}}</h1>
    <p>{{.Greeting}}</p>

    {{if .Error}}
    <p style="color: red">{{.Error}}</p>
    {{end}} {{if .ProcessedImage}}
    <p style="color: green">{{.Success}}</p>
    <h3>Processed Image:</h3>
    <img
        src="data:image/jpeg;base64,{{.ProcessedImage}}"
        alt="Processed Image"
    />
    {{end}}

    <form
        x-ref="uploadForm"
        action="/upload"
        method="POST"
        enctype="multipart/form-data"
    >
        <input type="text" name="name" id="name" placeholder="Name" />

        <input
            type="file"
            name="file"
            accept="image/jpeg,image/png"
            @change="validateFile($event)"
        />
        <p x-show="fileError" x-text="fileError" style="color: red"></p>
        <div style="display: flex; justify-content: flex-end">
            <input
                type="submit"
                value="Submit"
                :disabled="fileError !== ''"
                style="width: 200px"
            />
        </div>
    </form>
</div>
